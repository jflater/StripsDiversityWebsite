ggplot(aes(x = reorder(Sample, sample_sums.worle_manure.), y = sample_sums.worle_manure.)) +
geom_bar(stat = "identity")
worle_manure_mintax1 <- worle_manure %>%
filter_taxa(function(x) sum(x) >= 1, T)
rm(worle_manure)
data.frame(sample_sums(worle_manure_mintax1)) %>%
rownames_to_column(var = "Sample") %>%
as_tibble() %>%
ggplot(aes(x = reorder(Sample, sample_sums.worle_manure_mintax1.), y = sample_sums.worle_manure_mintax1.)) +
geom_bar(stat = "identity")
worle_manure_asvs <- taxa_names(worle_manure_mintax1)
worlephylo <- phylogeny_profile(worle_manure_mintax1, classification = "Phylum")
worlephylo + scale_color_manual(aesthetics = "fill", values = colors)
arm_soil_mintax1 <- subset_samples(arm, matrix == c("soil") & manure_treatment == c("N")) %>%
filter_taxa(function(x) sum(x) >= 1, T)
nsamples(arm_soil_mintax1)
kable(data.frame(sample_data(arm_soil_mintax1), row.names = NULL)) %>%
kable_styling(bootstrap_options = "striped") %>%
scroll_box(width = "100%", height = "600px")
arm_soil_asvs <- taxa_names(arm_soil_mintax1)
worle_soil_mintax1 <- subset_samples(worle, matrix == c("soil") & manure_treatment == c("N")) %>%
filter_taxa(function(x) sum(x) >= 1, T)
nsamples(arm_soil_mintax1)
kable(data.frame(sample_data(worle_soil_mintax1), row.names = NULL)) %>%
kable_styling(bootstrap_options = "striped") %>%
scroll_box(width = "100%", height = "600px")
worle_soil_asvs <- taxa_names(worle_soil_mintax1)
arm_vvv_diag <- venn(list("Manure_ASVs" = arm_manure_asvs, "Soil_ASVs" = arm_soil_asvs))
arm_manure_persitors <- attr(arm_vvv_diag, "intersections")$Manure_ASVs
worle_vvv_diag <- venn(list("Manure_ASVs" = worle_manure_asvs, "Soil_ASVs" = worle_soil_asvs))
worle_manure_persitors <- attr(worle_vvv_diag, "intersections")$Manure_ASVs
arm.soil.phy <- subset_samples(arm, matrix == "soil") %>%
filter_taxa(function(x) sum(x) >= 1, T) %>%
transform_sample_counts(function(x) x / sum(x))
unique(arm.soil.phy@sam_data$treatment)
armsoilphylo <- phylogeny_profile(arm.soil.phy, classification = "Phylum")
armsoilphylo + scale_color_manual(aesthetics = "fill", values = colors)
arm.persistors.phy <- prune_taxa(arm_manure_persitors, arm.soil.phy)
ntaxa(arm.persistors.phy)
kable(data.frame(sample_data(arm.persistors.phy), row.names = NULL)) %>%
kable_styling(bootstrap_options = "striped") %>%
scroll_box(width = "100%", height = "600px")
worle.soil.phy <- subset_samples(worle, matrix == "soil") %>%
filter_taxa(function(x) sum(x) >= 1, T) %>%
transform_sample_counts(function(x) x / sum(x))
worlesoilphylo <- phylogeny_profile(worle.soil.phy, classification = "Phylum")
worlesoilphylo + scale_color_manual(aesthetics = "fill", values = colors)
worle.persistors.phy <- prune_taxa(worle_manure_persitors, worle.soil.phy)
ntaxa(worle.persistors.phy)
kable(data.frame(sample_data(worle.persistors.phy), row.names = NULL)) %>%
kable_styling(bootstrap_options = "striped") %>%
scroll_box(width = "100%", height = "600px")
arm.melted <- psmelt(arm.persistors.phy)
unique(arm.melted$treatment)
arm.g <- ggplot(arm.melted, aes(x = in_plot_location, y = Abundance))
arm.plot <- arm.g +
geom_bar(aes(fill = Phylum), stat = "identity") +
facet_grid(sample_day~treatment)
arm.plot
worle.melted <- psmelt(worle.persistors.phy)
worle.g <- ggplot(worle.melted, aes(x = in_plot_location, y = Abundance))
worle.plot <- worle.g +
geom_bar(aes(fill = Phylum), stat = "identity") +
facet_grid(sample_day~treatment)
worle.plot
View(worle.melted)
rmarkdown::render_site()
setwd(dir = "../")
rmarkdown::render_site()
rmarkdown::render_site()
rmarkdown::render_site()
getwd()
knitr::opts_chunk$set(echo = TRUE)
worle <- readRDS("data/worle_tax_are_seqs.RDS")
arm <- readRDS("data/armstrong_tax_are_seqs.RDS")
worle
arm
rmarkdown::render_site()
library(phyloseq)
library(tidyverse)
library(ggplot2)
library(stats)
library(agricolae)
library(ggpubr)
StripsPhy <- readRDS("data/merged_STRIPs.RDS")
StripsPhy <- StripsPhy %>%
filter_taxa(function(x) sum(x) >= 1, T)
altstrips <- readRDS("data/all_samples_merged_STRIPS.RDS") %>%
filter_taxa(function(x) sum(x) >= 1, T)
altstrips
StripsPhy
rm(StripsPhy)
Wd1 <- subset_samples(altstrips, experiment %in% "Worle_Rainfall" & depth %in% 1 & !soil_type %in% "border") %>%
filter_taxa(function(x) sum(x) >= 1, T)
Wd1
kable(data.frame(sample_data(Wd1))) %>%
kable_styling(bootstrap_options = "striped") %>%
scroll_box(width = "100%", height = "600px")
library(kableExtra)
kable(data.frame(sample_data(Wd1))) %>%
kable_styling(bootstrap_options = "striped") %>%
scroll_box(width = "100%", height = "600px")
library(phylosmith)
data.frame(sample_sums(altstrips)) %>%
rownames_to_column(var = "Sample") %>%
as_tibble() %>%
ggplot(aes(x = reorder(Sample, sample_sums.altstrips.), y = sample_sums.altstrips.)) +
geom_bar(stat = "identity")
data.frame(sample_sums(altstrips)) %>%
rownames_to_column(var = "Sample") %>%
as_tibble()
data.frame(sample_sums(altstrips)) %>%
rownames_to_column(var = "Sample") %>%
as_tibble() %>%
filter(sample_sums.altstrips. <= 10000) %>%
ggplot(aes(x = reorder(Sample, sample_sums.altstrips.), y = sample_sums.altstrips.)) +
geom_bar(stat = "identity")
data.frame(sample_sums(altstrips)) %>%
rownames_to_column(var = "Sample") %>%
as_tibble() %>%
filter(sample_sums.altstrips. <= 10000) %>%
ggplot(aes(x = reorder(Sample, sample_sums.altstrips.), y = sample_sums.altstrips.)) +
geom_bar(stat = "identity") +
theme(axis.text.x = element_text(angle = 90, hjust = 1))
data.frame(sample_sums(altstrips))
data.frame(sample_sums(altstrips)) %>%
cbind(., data.frame(sample_data(altstrips)))
data.frame(sample_sums(altstrips)) %>%
cbind(., data.frame(sample_data(altstrips))) %>%
rownames_to_column(var = "Sample") %>%
as_tibble() %>%
filter(sample_sums.altstrips. <= 10000) %>%
ggplot(aes(x = reorder(Sample, sample_sums.altstrips.), y = sample_sums.altstrips.)) +
geom_bar(stat = "identity", aes(fill = matrix)) +
theme(axis.text.x = element_text(angle = 90, hjust = 1))
data.frame(sample_sums(altstrips)) %>%
cbind(., data.frame(sample_data(altstrips))) %>%
rownames_to_column(var = "Sample") %>%
as_tibble() %>%
filter(sample_sums.altstrips. <= 10000) %>%
ggplot(aes(x = reorder(Sample, sample_sums.altstrips.), y = sample_sums.altstrips.)) +
geom_bar(stat = "identity", aes(fill = matrix)) +
theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
facet(.~experiment)
data.frame(sample_sums(altstrips)) %>%
cbind(., data.frame(sample_data(altstrips))) %>%
rownames_to_column(var = "Sample") %>%
as_tibble() %>%
filter(sample_sums.altstrips. <= 10000) %>%
ggplot(aes(x = reorder(Sample, sample_sums.altstrips.), y = sample_sums.altstrips.)) +
geom_bar(stat = "identity", aes(fill = matrix)) +
theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
facet_grid(.~experiment)
data.frame(sample_sums(altstrips)) %>%
cbind(., data.frame(sample_data(altstrips))) %>%
rownames_to_column(var = "Sample") %>%
as_tibble() %>%
filter(sample_sums.altstrips. <= 10000) %>%
ggplot(aes(x = reorder(Sample, sample_sums.altstrips.), y = sample_sums.altstrips.)) +
geom_bar(stat = "identity", aes(fill = matrix)) +
theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
facet_grid(depth~experiment)
Wd1 <- subset_samples(altstrips, experiment %in% "Worle_Rainfall" & manure_treatment %in% "N" & !soil_type %in% "border" & depth %in% "1") %>%
filter_taxa(function(x) sum(x) >= 1, T)
Wd1
kable(data.frame(sample_data(Wd1))) %>%
kable_styling(bootstrap_options = "striped") %>%
scroll_box(width = "100%", height = "600px")
library(ggpubr)
sample_data <- sample_data(Wd1) %>%
lapply(., factor) %>%
as_tibble()
richness <- estimate_richness(Wd1)
sample_data <- cbind(sample_data, richness)
p <- ggboxplot(sample_data, x = "sample_day", y = "ACE", fill = "soil_type", add = "jitter")
plot <- p + stat_compare_means(aes(group = soil_type), label = "p.signif") +
ggtitle("ACE diversity index of WORLE detph 1 soils") +
ylab("ACE Diversity") +
xlab("Sampling Day") + scale_fill_viridis_d(name = "Managment", labels = c("Ag", "Prairie"))
plot
#ggsave("images/WorleD1ACE.png", plot = plot, device = "png", width = 6, height = 4, units = "in")
data.frame(sample_sums(altstrips)) %>%
cbind(., data.frame(sample_data(altstrips))) %>%
rownames_to_column(var = "Sample") %>%
as_tibble() %>%
filter(sample_sums.altstrips. <= 10000) %>%
print(nsamples()) %>%
ggplot(aes(x = reorder(Sample, sample_sums.altstrips.), y = sample_sums.altstrips.)) +
geom_bar(stat = "identity", aes(fill = matrix)) +
theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
facet_grid(depth~experiment)
data.frame(sample_sums(altstrips)) %>%
cbind(., data.frame(sample_data(altstrips))) %>%
rownames_to_column(var = "Sample") %>%
as_tibble() %>%
filter(sample_sums.altstrips. <= 10000) %>%
print(nsamples(.)) %>%
ggplot(aes(x = reorder(Sample, sample_sums.altstrips.), y = sample_sums.altstrips.)) +
geom_bar(stat = "identity", aes(fill = matrix)) +
theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
facet_grid(depth~experiment)
data.frame(sample_sums(altstrips)) %>%
cbind(., data.frame(sample_data(altstrips))) %>%
rownames_to_column(var = "Sample") %>%
as_tibble() %>%
filter(sample_sums.altstrips. <= 10000) %>%
print(nsamples(.))
data.frame(sample_sums(altstrips)) %>%
cbind(., data.frame(sample_data(altstrips))) %>%
rownames_to_column(var = "Sample") %>%
as_tibble() %>%
filter(sample_sums.altstrips. <= 10000) %>%
print(nrow()) %>%
ggplot(aes(x = reorder(Sample, sample_sums.altstrips.), y = sample_sums.altstrips.)) +
geom_bar(stat = "identity", aes(fill = matrix)) +
theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
facet_grid(depth~experiment)
data.frame(sample_sums(altstrips)) %>%
cbind(., data.frame(sample_data(altstrips))) %>%
rownames_to_column(var = "Sample") %>%
as_tibble() %>%
filter(sample_sums.altstrips. <= 10000) %>%
print(nrow(.)) %>%
ggplot(aes(x = reorder(Sample, sample_sums.altstrips.), y = sample_sums.altstrips.)) +
geom_bar(stat = "identity", aes(fill = matrix)) +
theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
facet_grid(depth~experiment)
data.frame(sample_sums(altstrips)) %>%
cbind(., data.frame(sample_data(altstrips))) %>%
rownames_to_column(var = "Sample") %>%
as_tibble() %>%
filter(sample_sums.altstrips. <= 10000) %>%
print(nrow(.))
data.frame(sample_sums(altstrips)) %>%
cbind(., data.frame(sample_data(altstrips))) %>%
rownames_to_column(var = "Sample") %>%
as_tibble() %>%
filter(sample_sums.altstrips. <= 10000) %T>% {print(dim(.))} %>%
ggplot(aes(x = reorder(Sample, sample_sums.altstrips.), y = sample_sums.altstrips.)) +
geom_bar(stat = "identity", aes(fill = matrix)) +
theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
facet_grid(depth~experiment)
data.frame(sample_sums(altstrips)) %>%
cbind(., data.frame(sample_data(altstrips))) %>%
rownames_to_column(var = "Sample") %>%
as_tibble() %>%
filter(sample_sums.altstrips. <= 10000) %T>% {print(nrow(.))} %>%
ggplot(aes(x = reorder(Sample, sample_sums.altstrips.), y = sample_sums.altstrips.)) +
geom_bar(stat = "identity", aes(fill = matrix)) +
theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
facet_grid(depth~experiment)
data.frame(sample_sums(altstrips)) %>%
cbind(., data.frame(sample_data(altstrips))) %>%
rownames_to_column(var = "Sample") %>%
as_tibble() %>%
filter(sample_sums.altstrips. <= 10000) %T>% {print(nrow(.)) + "Samples with less than 10k"} %>%
ggplot(aes(x = reorder(Sample, sample_sums.altstrips.), y = sample_sums.altstrips.)) +
geom_bar(stat = "identity", aes(fill = matrix)) +
theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
facet_grid(depth~experiment)
data.frame(sample_sums(altstrips)) %>%
cbind(., data.frame(sample_data(altstrips))) %>%
rownames_to_column(var = "Sample") %>%
as_tibble() %>%
filter(sample_sums.altstrips. <= 10000) %T>% {print(nrow(.))  "Samples with less than 10k"} %>%
data.frame(sample_sums(altstrips)) %>%
cbind(., data.frame(sample_data(altstrips))) %>%
rownames_to_column(var = "Sample") %>%
as_tibble() %>%
filter(sample_sums.altstrips. <= 10000) %T>% {print(nrow(.) + "Samples with less than 10k")} %>%
ggplot(aes(x = reorder(Sample, sample_sums.altstrips.), y = sample_sums.altstrips.)) +
geom_bar(stat = "identity", aes(fill = matrix)) +
theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
facet_grid(depth~experiment)
data.frame(sample_sums(altstrips)) %>%
cbind(., data.frame(sample_data(altstrips))) %>%
rownames_to_column(var = "Sample") %>%
as_tibble() %>%
filter(sample_sums.altstrips. <= 10000) %T>% {print(paste0("Samples with less than 10k",nrow(.)))} %>%
ggplot(aes(x = reorder(Sample, sample_sums.altstrips.), y = sample_sums.altstrips.)) +
geom_bar(stat = "identity", aes(fill = matrix)) +
theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
facet_grid(depth~experiment)
data.frame(sample_sums(altstrips)) %>%
cbind(., data.frame(sample_data(altstrips))) %>%
rownames_to_column(var = "Sample") %>%
as_tibble() %>%
filter(sample_sums.altstrips. <= 10000) %T>% {print(paste0(nrow(.), "Samples with less than 10k"))} %>%
ggplot(aes(x = reorder(Sample, sample_sums.altstrips.), y = sample_sums.altstrips.)) +
geom_bar(stat = "identity", aes(fill = matrix)) +
theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
facet_grid(depth~experiment)
data.frame(sample_sums(altstrips)) %>%
cbind(., data.frame(sample_data(altstrips))) %>%
rownames_to_column(var = "Sample") %>%
as_tibble() %>%
filter(sample_sums.altstrips. <= 10000) %T>% {print(paste0(nrow(.)," Samples with less than 10k"))} %>%
ggplot(aes(x = reorder(Sample, sample_sums.altstrips.), y = sample_sums.altstrips.)) +
geom_bar(stat = "identity", aes(fill = matrix)) +
theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
facet_grid(depth~experiment)
unique(altstrips@sam_data$sample_day)
Wdbase <- subset_samples(altstrips, experiment %in% "Worle_Rainfall" & sample_day %in% "Baseline" & !soil_type %in% "border" & depth %in% "1") %>%
filter_taxa(function(x) sum(x) >= 1, T)
Wdbase <- subset_samples(altstrips, experiment %in% "Worle_Rainfall" & sample_day %in% "Baseline" & !soil_type %in% "border" & depth %in% "1") %>%
filter_taxa(function(x) sum(x) >= 1, T) %>%
sample_data() %>%
lapply(., factor) %>%
as_tibble() %>%
cbind(., estimate_richness(.))
Wdbase <- subset_samples(altstrips, experiment %in% "Worle_Rainfall" & sample_day %in% "Baseline" & !soil_type %in% "border" & depth %in% "1") %>%
filter_taxa(function(x) sum(x) >= 1, T)
sample_data(Wdbase) %>%
lapply(., factor) %>%
as_tibble() %>%
cbind(., estimate_richness(Wdbase)) %>%
ggboxplot(x = "sample_day", y = "ACE", fill = "soil_type", add = "jitter")
sample_data(Wdbase) %>%
lapply(., factor) %>%
as_tibble() %>%
cbind(., estimate_richness(Wdbase)) %>%
ggboxplot(x = "sample_day", y = "ACE", fill = "soil_type", add = "jitter") +
stat_compare_means(aes(group = soil_type), label = "p.signif") +
ggtitle("ACE diversity index of WORLE baseline detph 1 soils") +
ylab("ACE Diversity") +
xlab("Sampling Day") + scale_fill_viridis_d(name = "Managment", labels = c("Ag", "Prairie"))
sample_data(Wdbase) %>%
lapply(., factor) %>%
as_tibble() %>%
cbind(., estimate_richness(Wdbase)) %>%
ggboxplot(x = "sample_day", y = "ACE", fill = "soil_type", add = "jitter") +
geom_point(aes(color = "in_plot_location")) +
stat_compare_means(aes(group = soil_type), label = "p.signif") +
ggtitle("ACE diversity index of WORLE baseline detph 1 soils") +
ylab("ACE Diversity") +
xlab("Sampling Day") + scale_fill_viridis_d(name = "Managment", labels = c("Ag", "Prairie"))
sample_data(Wdbase) %>%
lapply(., factor) %>%
as_tibble() %>%
cbind(., estimate_richness(Wdbase)) %>%
ggboxplot(x = "sample_day", y = "ACE", fill = "soil_type", add = "jitter", notch = T) +
stat_compare_means(aes(group = soil_type), label = "p.signif") +
ggtitle("ACE diversity index of WORLE baseline detph 1 soils") +
ylab("ACE Diversity") +
xlab("Sampling Day") + scale_fill_viridis_d(name = "Managment", labels = c("Ag", "Prairie"))
plot <- p + stat_compare_means(aes(group = soil_type), label = "p.signif") +
ggtitle("ACE diversity index of WORLE detph 1 soils") +
ylab("ACE Diversity") +
xlab("Sampling Day") + scale_fill_viridis_d(name = "Managment", labels = c("Ag", "Prairie"))
plot
p <- ggboxplot(sample_data, x = "sample_day", y = "ACE", fill = "soil_type", add = "jitter", notch = T)
plot <- p + stat_compare_means(aes(group = soil_type), label = "p.signif") +
ggtitle("ACE diversity index of WORLE detph 1 soils") +
ylab("ACE Diversity") +
xlab("Sampling Day") + scale_fill_viridis_d(name = "Managment", labels = c("Ag", "Prairie"))
plot
p <- ggboxplot(sample_data, x = "sample_day", y = "ACE", fill = "soil_type", add = "jitter", notch = F)
plot <- p + stat_compare_means(aes(group = soil_type), label = "p.signif") +
ggtitle("ACE diversity index of WORLE detph 1 soils") +
ylab("ACE Diversity") +
xlab("Sampling Day") + scale_fill_viridis_d(name = "Managment", labels = c("Ag", "Prairie"))
plot
p <- ggboxplot(sample_data, x = "sample_day", y = "Chao1", fill = "soil_type", add = "jitter")
plot <- p + stat_compare_means(aes(group = soil_type), label = "p.signif") +
ggtitle("Chao1 diversity index of WORLE detph 1 soils") +
ylab("Chao1 Diversity") +
xlab("Sampling Day") + scale_fill_viridis_d(name = "Managment", labels = c("Ag", "Prairie"))
plot
ggsave("images/WorleD1Chao1.png", plot = plot, device = "png", width = 6, height = 4, units = "in")
p <- ggboxplot(sample_data, x = "sample_day", y = "Shannon", fill = "soil_type", add = "jitter")
plot <- p + stat_compare_means(aes(group = soil_type), label = "p.signif") +
ggtitle("Shannon diversity index of WORLE detph 1 soils") +
ylab("Shannon Diversity") +
xlab("Sampling Day") + scale_fill_viridis_d(name = "Managment", labels = c("Ag", "Prairie"))
plot
ggsave("images/WorleD1Shannon.png", plot = plot, device = "png", width = 6, height = 4, units = "in")
View(sample_data)
rWd1 <- rarefy_even_depth(Wd1, sample.size = 10000, rngseed = 12121212, trimOTUs = T)
rsample_data1 <- sample_data(rWd1) %>%
lapply(., factor) %>%
as_tibble()
richness <- estimate_richness(rWd1)
rsample_data <- cbind(rsample_data1, richness)
p <- ggboxplot(rsample_data, x = "sample_day", y = "Shannon", fill = "soil_type", add = "jitter")
plot <- p + stat_compare_means(aes(group = soil_type), label = "p.signif") +
ggtitle("Shannon diversity index of WORLE detph 1 soils, rarefied to 10k") +
ylab("Shannon Diversity") +
xlab("Sampling Day") + scale_fill_viridis_d(name = "Managment", labels = c("Ag", "Prairie"))
plot
ggsave("images/rWd1Shannon.png", plot = plot, device = "png", width = 6, height = 4, units = "in")
levels(as.factor(sample_data$sample_day))
levels(as.factor(p$sample_day))
p <- sample_data %>%
filter(soil_type == "strip") %>%
ggboxplot(x = "sample_day", y = "Shannon", add = "jitter")
my_comparisons <- list( c("T002", "T014"), c("T002", "T000"), c("Baseline", "T000"), c("T014", "T021"), c("T021", "T042"))
plot <- p + stat_compare_means(comparisons = my_comparisons, label = "p.signif") +
ggtitle("Shannon diversity index of WORLE detph 1 strip soils") +
ylab("Shannon Diversity") +
xlab("Sampling Day")
plot
sample_data %>%
filter(soil_type == "strip")
p <- rsample_data %>%
filter(soil_type == "strip") %>%
ggboxplot(x = "sample_day", y = "Shannon", add = "jitter")
my_comparisons <- list( c("T002", "T014"), c("T002", "T000"), c("Baseline", "T000"), c("T014", "T021"), c("T021", "T042"))
plot <- p + stat_compare_means(comparisons = my_comparisons, label = "p.signif") +
ggtitle("Shannon diversity index of WORLE detph 1 strip soils, rarefied 10k") +
ylab("Shannon Diversity") +
xlab("Sampling Day")
plot
p <- rsample_data %>%
filter(soil_type == "crop") %>%
ggboxplot(x = "sample_day", y = "Shannon", add = "jitter")
p
my_comparisons <- list( c("T002", "T014"), c("T002", "T000"), c("Baseline", "T000"), c("T014", "T021"), c("T021", "T042"))
plot <- p + stat_compare_means(comparisons = my_comparisons, label = "p.signif") +
ggtitle("Shannon diversity index of WORLE detph 1 Crop soils, rarefied 10k") +
ylab("Shannon Diversity") +
xlab("Sampling Day")
plot
p <- rsample_data %>%
filter(soil_type == "strip") %>%
ggboxplot(x = "sample_day", y = "Shannon", add = "jitter")
my_comparisons <- list( c("T002", "T014"), c("T002", "T000"), c("Baseline", "T000"), c("T014", "T021"), c("T021", "T042"))
plot <- p + stat_compare_means(comparisons = my_comparisons, label = "p.signif") +
ggtitle("Shannon diversity index of WORLE detph 1 prairie soils, rarefied 10k") +
ylab("Shannon Diversity") +
xlab("Sampling Day")
plot
p <- rsample_data %>%
filter(soil_type == "crop") %>%
ggboxplot(x = "sample_day", y = "Shannon", add = "jitter")
my_comparisons <- list( c("T002", "T014"), c("T002", "T000"), c("Baseline", "T000"), c("T014", "T021"), c("T021", "T042"))
plot <- p + stat_compare_means(comparisons = my_comparisons, label = "p.signif") +
ggtitle("Shannon diversity index of WORLE detph 1 ag soils, rarefied 10k") +
ylab("Shannon Diversity") +
xlab("Sampling Day")
plot
p <- sample_data %>%
filter(soil_type == "strip") %>%
ggboxplot(x = "sample_day", y = "ACE", add = "jitter")
p
my_comparisons <- list( c("T002", "T014"), c("T002", "T000"), c("Baseline", "T000"), c("T014", "T021"), c("T021", "T042"))
plot <- p + stat_compare_means(comparisons = my_comparisons, label = "p.signif") +
ggtitle("ACE diversity index of WORLE depth 1 prairie soils") +
ylab("ACE Diversity") +
xlab("Sampling Day")
plot
Wd2 <- subset_samples(altstrips, experiment %in% "Worle_Rainfall" & manure_treatment %in% "N" & !soil_type %in% "border" & depth %in% "2") %>%
filter_taxa(function(x) sum(x) >= 2, T)
Wd2
kable(data.frame(sample_data(Wd2))) %>%
kable_styling(bootstrap_options = "striped") %>%
scroll_box(width = "100%", height = "600px")
sample_data <- sample_data(Wd2) %>%
lapply(., factor) %>%
as_tibble()
richness <- estimate_richness(Wd2)
sample_data <- cbind(sample_data, richness)
p <- ggboxplot(sample_data, x = "sample_day", y = "ACE", fill = "soil_type", add = "jitter")
plot <- p + stat_compare_means(aes(group = soil_type), label = "p.signif") +
ggtitle("ACE diversity index of WORLE detph 2 soils") +
ylab("ACE Diversity") +
xlab("Sampling Day") + scale_fill_viridis_d(name = "Managment", labels = c("Ag", "Prairie"))
plot
ggsave("images/WorleD2ACE.png", plot = plot, device = "png", width = 6, height = 4, units = "in")
sample_data <- sample_data(Wd2) %>%
lapply(., factor) %>%
as_tibble()
richness <- estimate_richness(Wd2)
sample_data <- cbind(sample_data, richness)
p <- ggboxplot(sample_data, x = "sample_day", y = "Chao1", fill = "soil_type", add = "jitter")
plot <- p + stat_compare_means(aes(group = soil_type), label = "p.signif") +
ggtitle("Chao1 diversity index of WORLE detph 2 soils") +
ylab("Chao1 Diversity") +
xlab("Sampling Day") + scale_fill_viridis_d(name = "Managment", labels = c("Ag", "Prairie"))
plot
ggsave("images/WorleD2Chao1.png", plot = plot, device = "png", width = 6, height = 4, units = "in")
rWd2 <- rarefy_even_depth(Wd2, sample.size = 10000, rngseed = 12121212, trimOTUs = T)
sample_data2 <- sample_data(rWd2) %>%
lapply(., factor) %>%
as_tibble()
richness <- estimate_richness(rWd2)
sample_data2 <- cbind(sample_data2, richness)
p <- ggboxplot(sample_data2, x = "sample_day", y = "Shannon", fill = "soil_type", add = "jitter")
plot <- p + stat_compare_means(aes(group = soil_type), label = "p.signif") +
ggtitle("Shannon diversity index of WORLE detph 2 soils rarefied to 10k reads") +
ylab("Shannon Diversity") +
xlab("Sampling Day") + scale_fill_viridis_d(name = "Managment", labels = c("Ag", "Prairie"))
plot
ggsave("images/WorlerD2Shannon.png", plot = plot, device = "png", width = 6, height = 4, units = "in")
# sample data 2 is rarefied, this is shannon
p <- sample_data2 %>%
filter(soil_type == "strip") %>%
ggboxplot(x = "sample_day", y = "Shannon", add = "jitter")
my_comparisons <- list( c("T002", "T014"), c("T002", "T000"), c("Baseline", "T000"), c("T014", "T021"), c("T021", "T042"))
plot <- p + stat_compare_means(comparisons = my_comparisons, label = "p.signif") +
ggtitle("Shannon diversity index of WORLE detph 2 Prairie soils, rarefied to 10k") +
ylab("Shannon Diversity") +
xlab("Sampling Day")
plot
p <- sample_data %>%
filter(soil_type == "strip") %>%
ggboxplot(x = "sample_day", y = "ACE", add = "jitter")
my_comparisons <- list( c("T002", "T014"), c("T002", "T000"), c("Baseline", "T000"), c("T014", "T021"), c("T021", "T042"))
plot <- p + stat_compare_means(comparisons = my_comparisons, label = "p.signif") +
ggtitle("ACE diversity index of WORLE depth 2 Prairie soils") +
ylab("ACE Diversity") +
xlab("Sampling Day")
plot
